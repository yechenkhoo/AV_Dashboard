<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Personalisation</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel="stylesheet" href="../static/css/main.css">
    <link rel="stylesheet" href="../static/css/personalisation.css">
</head>

<body>
    <nav class="navbar navbar-light bg-light fixed-bottom">
        <div class="container d-flex justify-content-center">
            <a class="nav-link" href="../pages/dashboard2.html"><i class="fa-solid fa-house" style="color: #000000;"></i></a>
            <a class="nav-link" href="../pages/entertainment_options.html"><i class="fa-brands fa-spotify" style="color: #000000;"></i></a>
            <a class="nav-link" href="../pages/car_health.html"><i class="fa-solid fa-heart-pulse" style="color: #000000;"></i></a>
            <a class="nav-link" href="../pages/live_traffic.html"><i class="fa-solid fa-traffic-light" style="color: #000000;"></i></a>
            <a class="nav-link" href="../pages/safety_and_emergency_services.html"><i class="fa-solid fa-triangle-exclamation" style="color: #000000;"></i></a>
            <a class="nav-link" href="../pages/personalisation.html"><i class="fa-solid fa-sliders" style="color: #000000;"></i></a>
            <a class="nav-link" href="../pages/help.html"><i class="fa-solid fa-circle-question" style="color: #000000;"></i></a>
        </div>
    </nav>
    
    <div id="brightness-wrapper"></div>

    <div class="page-header">
        <i class="fa-solid fa-arrow-left-long fa-3x" onclick="window.history.back()"></i>
        <div class="page-title" id="header-title">Personalisation</div>
    </div>

    <div id="display-setting" style="width:100%">
        <div class="subheading subheading-display">Display Settings</div>
        
        <div class="cards-container">
            <!-- brightness -->
            <div class="card">
                <div class="card-header">
                    <div class="header-content">
                        <i class="fa-solid fa-sun fa-2x" style="margin-right: 10px;"></i>
                        <span style="font-size: 18px;">Brightness</span>
                    </div>
                    <div class="slider-container">
                        <input type="range" class="slider" style="width: 250px;" min="0" max="100" value="50">
                        <div class="slider-labels">
                            <span>Low</span>
                            <span>High</span>
                        </div>
                    </div>
                </div>
            </div>
           <!-- Font size -->
            <div class="card">
                <div class="card-header">
                    <div class="header-content">
                        <i class="fa-solid fa-a fa-2x" style="margin-right: 10px;"></i>
                        <span style="font-size: 18px;">Font Size</span>
                    </div>
                    <div class="slider-container">
                        <input type="range" class="slider" style="width: 250px;" min="0" max="100" value="50">
                        <div class="slider-labels">
                            <span><i class="fa-solid fa-a fa-1x" style="margin-right: 10px;"></i></span>
                            <span><i class="fa-solid fa-a fa-2x" style="margin-right: 10px;"></i></span>
                        </div>
                    </div>
                </div>
            </div>
            <!-- language -->
            <div class="card">
                <div class="card-header">
                    <div class="header-content">
                        <i class="fa-solid fa-language fa-2x" style="margin-right: 10px;"></i>
                        <span style="font-size: 18px;">Language</span>
                    </div>
                    <div class="dropdown-container">
                        <select class="form-control" id="languageSelect" style="width: 250px; display: inline-block;">
                            <option value="english">English</option>
                            <option value="spanish">Spanish</option>
                            <option value="french">French</option>
                            <option value="german">German</option>
                            <option value="chinese">Chinese</option>
                        </select>
                    </div>
                </div>
            </div>
            <!-- light/ dark mode -->
            <div class="card">
                <div class="card-header">
                    <div class="header-content">
                        <i class="fa-solid fa-palette fa-2x" style="margin-right: 10px;"></i>
                        <span id="themeText" style="font-size: 18px;">Light Mode</span>
                    </div>

                    <!-- Toggle Button -->
                    <div style="margin-left: auto; margin-top: 10px;">
                        <label class="custom-toggle">
                            <input type="checkbox" id="darkModeToggle">
                            <span></span>
                        </label>
                    </div>
                </div>
            </div>
        </div>
        <!-- Language Confirmation Modal -->
        <div class="modal fade" id="languageModal" tabindex="-1" role="dialog" aria-labelledby="languageModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="languageModalLabel">Confirm Language Change</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        Are you sure you want to change the language to <span id="selectedLanguage"></span>?
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-primary" id="confirmLanguage">Confirm</button>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- Required Bootstrap JavaScript -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.3/dist/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

    <script src="../static/js/dark_light_mode_toggle.js"></script>

    <script>
        // Function to update brightness
        const slider = document.querySelector('.slider');
        const brightnessWrapper = document.getElementById('brightness-wrapper');

        function updateBrightness(value) {
            // Convert the brightness value (0-100) to a more suitable opacity range
            // Limit the maximum opacity to 0.7 (70%) to prevent complete darkness
            // Invert the scale so higher values mean brighter
            const maxOpacity = 0.6;
            const minOpacity = 0;
            const opacity = maxOpacity - ((value / 100) * (maxOpacity - minOpacity));
            
            // Apply the opacity to the brightness wrapper
            brightnessWrapper.style.backgroundColor = `rgba(0, 0, 0, ${opacity})`;
            
            // Update slider background for visual feedback
            const percent = (value / slider.max) * 100;
            slider.style.background = `linear-gradient(to right, #0d6efd ${percent}%, #e9ecef ${percent}%)`;
        }
        // Add slider event listener
        slider.addEventListener('input', (e) => {
                const brightness = e.target.value;
                updateBrightness(brightness);
                
                // Save to localStorage
                localStorage.setItem('pageBrightness', brightness);
            });

            // Load saved brightness
            const savedBrightness = localStorage.getItem('pageBrightness');
            if (savedBrightness) {
                slider.value = savedBrightness;
                updateBrightness(savedBrightness);
            } else {
                // Initialize with default value
                updateBrightness(90);
            }  

        
        // Language selection code
        const languageSelect = document.getElementById('languageSelect');
        let previousLanguage = languageSelect.value;

        languageSelect.addEventListener('change', function(e) {
            const selectedLanguage = this.value;
            const displayLanguage = this.options[this.selectedIndex].text;
            
            // Update modal content
            document.getElementById('selectedLanguage').textContent = displayLanguage;
            
            // Show confirmation modal
            $('#languageModal').modal('show');
            
            // Reset to previous selection until confirmed
            this.value = previousLanguage;
        });

        // Handle confirmation
        document.getElementById('confirmLanguage').addEventListener('click', function() {
            const newLanguage = document.getElementById('selectedLanguage').textContent;
            const selectElement = document.getElementById('languageSelect');
            
            // Find and select the option with matching text
            for(let option of selectElement.options) {
                if(option.text === newLanguage) {
                    selectElement.value = option.value;
                    previousLanguage = option.value;
                    break;
                }
            }
            
            // Save to localStorage
            localStorage.setItem('selectedLanguage', selectElement.value);
            
            // Close the modal
            $('#languageModal').modal('hide');
            
            // Here you would typically implement the actual language change
            console.log('Language changed to:', newLanguage);
        });

        // Load saved language
        const savedLanguage = localStorage.getItem('selectedLanguage');
        if (savedLanguage) {
            languageSelect.value = savedLanguage;
            previousLanguage = savedLanguage;
        }
        
        // Function to set the selected color and apply styling
        function setSelectedColor(colorElement) {
            // Remove 'selected' class from all options
            document.querySelectorAll('.color-option').forEach(option => {
                option.classList.remove('selected');
            });

            // Add 'selected' class to the clicked option
            colorElement.classList.add('selected');
            
            // Apply the background color based on the selected element's background
            const color = window.getComputedStyle(colorElement).backgroundColor;
            document.body.style.backgroundColor = color;

            // Save the selected color in localStorage
            localStorage.setItem('selectedColor', color);
        }

        // Event listener for each color option
        document.querySelectorAll('.color-option').forEach(option => {
            option.addEventListener('click', () => {
                setSelectedColor(option);
            });
        });

        
        </script>

</body>
</html>
<!-- // // Load saved color from localStorage
// const savedColor = localStorage.getItem('selectedColor');
// if (savedColor) {
//     // Find the color option with this background color and apply it
//     document.body.style.backgroundColor = savedColor;
//     document.querySelectorAll('.color-option').forEach(option => {
//         if (window.getComputedStyle(option).backgroundColor === savedColor) {
//             option.classList.add('selected');
//         }
//     });
// } else {
//     // Set a default color if none is saved
//     document.body.style.backgroundColor = 'rgb(59, 130, 246)'; // Default to blue
// } -->

            <!-- colour -->
            <!-- <div class="card">
                <div class="card-header">
                    <div class="header-content">
                        <i class="fa-solid fa-palette fa-2x" style="margin-right: 10px;"></i>
                        <span style="font-size: 18px;">Color</span>
                    </div>
                    
                    <div class="color-options">
                        <div class="color-option selected" style="background: #202124" data-color="blue"></div>
                        <div class="color-option" style="background: #b3A394" data-color="green"></div>
                        <div class="color-option" style="background: #2C6E49" data-color="purple"></div>
                        <div class="color-option" style="background: #3D52D5" data-color="orange"></div>
                    </div>
                </div>
            </div> -->